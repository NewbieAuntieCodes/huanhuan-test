ğŸ“Š é¡¹ç›®ä»£ç è´¨é‡è¯„ä¼°

å½“å‰é—®é¢˜

1. è¶…å¤§æ–‡ä»¶ (>400 è¡Œ)ï¼š7 ä¸ªæ–‡ä»¶ä»£ç è¿‡é•¿ï¼Œéš¾ä»¥ç»´æŠ¤
2. èŒè´£æ··ä¹±ï¼šä¸šåŠ¡é€»è¾‘ã€UI æ¸²æŸ“ã€çŠ¶æ€ç®¡ç†æ··åœ¨ä¸€èµ·
3. é‡å¤ä»£ç ï¼šéŸ³é¢‘å¤„ç†ã€æ•°æ®åº“æ“ä½œæ•£è½å„å¤„
4. ç´§è€¦åˆï¼šWebSocket é€»è¾‘ç›´æ¥å†™åœ¨ App.tsx
5. ç¼ºä¹æŠ½è±¡ï¼šæ²¡æœ‰ç»Ÿä¸€çš„æœåŠ¡å±‚å°è£…

---

ğŸ¯ é‡æ„ä¼˜å…ˆçº§åˆ—è¡¨

ğŸ”´ é«˜ä¼˜å…ˆçº§ - ç«‹å³é‡æ„

1. WebSocket ç®¡ç†æœåŠ¡

å½“å‰é—®é¢˜ï¼šApp.tsx:40-96 ä¸­åŒ…å«å®Œæ•´çš„ WebSocket è¿æ¥é€»è¾‘
// å»ºè®®æ‹†åˆ†ä¸ºï¼š
src/services/websocketService.ts // WebSocket è¿æ¥ç®¡ç†
src/hooks/useWebSocket.ts // React Hook å°è£…

é‡æ„æ”¶ç›Šï¼š

- âœ… å…³æ³¨ç‚¹åˆ†ç¦»
- âœ… å¯æµ‹è¯•æ€§æå‡
- âœ… å¯å¤ç”¨æ€§å¢å¼º

---

2. æ•°æ®åº“æ“ä½œå±‚ç»Ÿä¸€å°è£…

å½“å‰é—®é¢˜ï¼šDexie æ•°æ®åº“æ“ä½œæ•£è½åœ¨å„ä¸ª slice å’Œç»„ä»¶ä¸­
// å»ºè®®åˆ›å»ºï¼š
src/repositories/
â”œâ”€â”€ projectRepository.ts // é¡¹ç›®æ•°æ®æ“ä½œ
â”œâ”€â”€ characterRepository.ts // è§’è‰²æ•°æ®æ“ä½œ
â”œâ”€â”€ audioRepository.ts // éŸ³é¢‘æ•°æ®æ“ä½œ
â””â”€â”€ miscRepository.ts // æ‚é¡¹æ•°æ®æ“ä½œ

é‡æ„æ”¶ç›Šï¼š

- âœ… ç»Ÿä¸€é”™è¯¯å¤„ç†
- âœ… äº‹åŠ¡ç®¡ç†é›†ä¸­
- âœ… æ•°æ®éªŒè¯ç»Ÿä¸€

---

3. éŸ³é¢‘å¤„ç†å·¥å…·åº“æ•´åˆ

å½“å‰é—®é¢˜ï¼šéŸ³é¢‘ç›¸å…³é€»è¾‘åˆ†æ•£åœ¨å¤šä¸ªæ–‡ä»¶
// å½“å‰æ–‡ä»¶ï¼š
src/lib/audioProcessing.ts
src/lib/wavEncoder.ts
src/lib/wavExporter.ts
src/features/audioAlignment/hooks/useWaveSurfer.ts (442 è¡Œ)
src/features/audioAlignment/hooks/useAudioFileMatcher.ts (564 è¡Œ)

// å»ºè®®é‡æ„ä¸ºï¼š
src/services/audio/
â”œâ”€â”€ index.ts // ç»Ÿä¸€å¯¼å‡º
â”œâ”€â”€ audioDecoder.ts // éŸ³é¢‘è§£ç 
â”œâ”€â”€ audioEncoder.ts // éŸ³é¢‘ç¼–ç 
â”œâ”€â”€ waveSurferManager.ts // æ³¢å½¢ç®¡ç†
â”œâ”€â”€ audioMatcher.ts // éŸ³é¢‘åŒ¹é…é€»è¾‘
â”œâ”€â”€ metadataParser.ts // å…ƒæ•°æ®è§£æ (XMP CuePoints ç­‰)
â””â”€â”€ audioUtils.ts // é€šç”¨å·¥å…·

é‡æ„æ”¶ç›Šï¼š

- âœ… ä»£ç å¤ç”¨ç‡æå‡ 60%+
- âœ… å‡å°‘ bug ä¿®å¤æˆæœ¬
- âœ… æ›´å¥½çš„ç±»å‹æ¨å¯¼

---

ğŸŸ¡ ä¸­ä¼˜å…ˆçº§ - é€æ­¥ä¼˜åŒ–

4. è¶…å¤§ Hook æ‹†åˆ†

useAudioFileMatcher.ts (564 è¡Œ)
// å»ºè®®æ‹†åˆ†ä¸ºï¼š
src/features/audioAlignment/hooks/
â”œâ”€â”€ useAudioFileMatcher.ts // ä¸»é€»è¾‘åè°ƒ
â”œâ”€â”€ useChapterParser.ts // ç« èŠ‚è§£æé€»è¾‘
â”œâ”€â”€ useXmpCuePointParser.ts // XMP æ ‡è®°è§£æ
â”œâ”€â”€ useAudioSegmentProcessor.ts // éŸ³é¢‘ç‰‡æ®µå¤„ç†
â””â”€â”€ useFileUploadHandler.ts // æ–‡ä»¶ä¸Šä¼ å¤„ç†

useWaveSurfer.ts (442 è¡Œ)
// å»ºè®®æ‹†åˆ†ä¸ºï¼š
src/features/audioAlignment/hooks/
â”œâ”€â”€ useWaveSurfer.ts // ä¸»è¦åè°ƒé€»è¾‘
â”œâ”€â”€ useWaveformRenderer.ts // æ³¢å½¢æ¸²æŸ“
â”œâ”€â”€ useMarkerManager.ts // æ ‡è®°ç®¡ç†
â”œâ”€â”€ usePlaybackControl.ts // æ’­æ”¾æ§åˆ¶
â””â”€â”€ useHotkeys.ts // å¿«æ·é”®ç®¡ç†

---

5. ç»„ä»¶èŒè´£æ‹†åˆ†

AudioScriptLine.tsx (402 è¡Œ)
// å½“å‰é—®é¢˜ï¼šåŒ…å« UI + é€»è¾‘ + çŠ¶æ€ç®¡ç†
// å»ºè®®æ‹†åˆ†ä¸ºï¼š
AudioScriptLine.tsx // å®¹å™¨ç»„ä»¶
â”œâ”€â”€ ScriptLineView.tsx // çº¯å±•ç¤ºç»„ä»¶
â”œâ”€â”€ useScriptLineLogic.ts // ä¸šåŠ¡é€»è¾‘ hook
â””â”€â”€ ScriptLineControls.tsx // æ§åˆ¶æŒ‰é’®ç»„

GlobalAudioPlayer.tsx (385 è¡Œ)
// å»ºè®®æ‹†åˆ†ä¸ºï¼š
GlobalAudioPlayer.tsx
â”œâ”€â”€ AudioPlayerUI.tsx // æ’­æ”¾å™¨ç•Œé¢
â”œâ”€â”€ useAudioPlayback.ts // æ’­æ”¾é€»è¾‘
â”œâ”€â”€ useAudioQueue.ts // æ’­æ”¾é˜Ÿåˆ—ç®¡ç†
â””â”€â”€ PlayerControls.tsx // æ’­æ”¾æ§åˆ¶ç»„ä»¶

---

6. çŠ¶æ€ç®¡ç†ä¼˜åŒ–

å½“å‰é—®é¢˜ï¼šuseStore.ts ä¸­çš„ loadInitialData åŒ…å«å¤ªå¤šä¸šåŠ¡é€»è¾‘
// å»ºè®®ï¼š
src/store/
â”œâ”€â”€ useStore.ts // ä¸» store
â”œâ”€â”€ slices/ // ç°æœ‰ slices
â”œâ”€â”€ actions/ // å¤æ‚ä¸šåŠ¡é€»è¾‘æŠ½å–
â”‚ â”œâ”€â”€ initActions.ts // åˆå§‹åŒ–é€»è¾‘
â”‚ â”œâ”€â”€ colorPresetActions.ts // é¢œè‰²é¢„è®¾åŒæ­¥é€»è¾‘
â”‚ â””â”€â”€ migrationActions.ts // æ•°æ®è¿ç§»é€»è¾‘
â””â”€â”€ selectors/ // æ´¾ç”ŸçŠ¶æ€è®¡ç®—
â”œâ”€â”€ projectSelectors.ts
â””â”€â”€ characterSelectors.ts

---

ğŸŸ¢ ä½ä¼˜å…ˆçº§ - é•¿æœŸä¼˜åŒ–

7. ç±»å‹ç³»ç»Ÿå¢å¼º

// å»ºè®®åˆ›å»ºï¼š
src/types/
â”œâ”€â”€ index.ts // ä¸»å¯¼å‡º
â”œâ”€â”€ project.types.ts // é¡¹ç›®ç›¸å…³ç±»å‹
â”œâ”€â”€ character.types.ts // è§’è‰²ç›¸å…³ç±»å‹
â”œâ”€â”€ audio.types.ts // éŸ³é¢‘ç›¸å…³ç±»å‹
â”œâ”€â”€ ui.types.ts // UI çŠ¶æ€ç±»å‹
â””â”€â”€ api.types.ts // API å“åº”ç±»å‹

8. é…ç½®æ–‡ä»¶ç»Ÿä¸€ç®¡ç†

src/config/
â”œâ”€â”€ constants.ts // å…¨å±€å¸¸é‡
â”œâ”€â”€ waveformConfig.ts // æ³¢å½¢é…ç½®
â”œâ”€â”€ websocketConfig.ts // WebSocket é…ç½®
â””â”€â”€ defaultValues.ts // é»˜è®¤å€¼é›†åˆ

9. é”™è¯¯å¤„ç†ç»Ÿä¸€

src/utils/
â”œâ”€â”€ errorHandler.ts // ç»Ÿä¸€é”™è¯¯å¤„ç†
â”œâ”€â”€ logger.ts // æ—¥å¿—å·¥å…·
â””â”€â”€ validators.ts // æ•°æ®éªŒè¯

---

ğŸ“ å…·ä½“é‡æ„ç¤ºä¾‹

ç¤ºä¾‹ 1ï¼šWebSocket æœåŠ¡æŠ½å–

é‡æ„å‰ (App.tsx:40-96)ï¼š
// 220 è¡Œç»„ä»¶ä¸­æ··æ‚ WebSocket é€»è¾‘
useEffect(() => {
const connectWebSocket = () => {
const socket = new WebSocket('ws://127.0.0.1:9002');
// ... 60 è¡Œ WebSocket é€»è¾‘
};
connectWebSocket();
}, []);

é‡æ„åï¼š
// src/services/websocketService.ts
export class WebSocketService {
private socket: WebSocket | null = null;
private reconnectTimeout: number | null = null;

    connect(url: string, callbacks: WebSocketCallbacks) {
      // ... è¿æ¥é€»è¾‘
    }

    disconnect() { /* ... */ }
    send(data: any) { /* ... */ }

}

// src/hooks/useWebSocket.ts
export function useWebSocket(url: string) {
const [status, setStatus] = useState<'connecting' | 'connected' | 'disconnected'>('disconnected');
// ... hook é€»è¾‘
return { status, send };
}

// App.tsx (ç®€åŒ–ä¸º 3 è¡Œ)
const { status } = useWebSocket('ws://127.0.0.1:9002');

---

ç¤ºä¾‹ 2ï¼šéŸ³é¢‘å¤„ç†æœåŠ¡æ•´åˆ

é‡æ„å‰ï¼š
// useAudioFileMatcher.ts ä¸­åŒ…å« XMP è§£æã€éŸ³é¢‘åˆ‡åˆ†ã€å…ƒæ•°æ®å¤„ç†ç­‰å¤šç§èŒè´£

é‡æ„åï¼š
// src/services/audio/metadataParser.ts
export class XmpCuePointParser {
parse(metadata: any, duration: number): CuePoint[] {
// ä¸“æ³¨äº XMP è§£æ
}
}

// src/services/audio/audioMatcher.ts
export class AudioMatcher {
constructor(
private parser: XmpCuePointParser,
private segmentProcessor: AudioSegmentProcessor
) {}

    async matchFiles(files: File[]): Promise<MatchResult[]> {
      // é«˜å±‚åè°ƒé€»è¾‘
    }

}

// useAudioFileMatcher.ts (å‡å°‘åˆ° 150 è¡Œ)
export function useAudioFileMatcher(props) {
const matcher = useMemo(() => new AudioMatcher(...), []);
// åªå¤„ç† React ç›¸å…³é€»è¾‘
}

---

ğŸ› ï¸ é‡æ„æ‰§è¡Œè®¡åˆ’

é˜¶æ®µ 1ï¼šåŸºç¡€è®¾æ–½ (1-2 å‘¨)

1. âœ… åˆ›å»º services/ ç›®å½•ç»“æ„
2. âœ… æŠ½å– WebSocket æœåŠ¡
3. âœ… åˆ›å»º Repository å±‚
4. âœ… ç»Ÿä¸€é…ç½®ç®¡ç†

é˜¶æ®µ 2ï¼šæ ¸å¿ƒåŠŸèƒ½ (2-3 å‘¨)

5. âœ… é‡æ„éŸ³é¢‘å¤„ç†æ¨¡å—
6. âœ… æ‹†åˆ†è¶…å¤§ Hooks
7. âœ… ç»„ä»¶èŒè´£åˆ†ç¦»

é˜¶æ®µ 3ï¼šä¼˜åŒ–æå‡ (1-2 å‘¨)

8. âœ… çŠ¶æ€ç®¡ç†ä¼˜åŒ–
9. âœ… ç±»å‹ç³»ç»Ÿå¢å¼º
10. âœ… å•å…ƒæµ‹è¯•è¡¥å……

---

âš ï¸ é‡æ„æ³¨æ„äº‹é¡¹

1. å¢é‡é‡æ„ï¼šä¸è¦ä¸€æ¬¡æ€§é‡æ„æ‰€æœ‰ä»£ç 
2. ä¿æŒåŠŸèƒ½ç¨³å®šï¼šæ¯æ¬¡é‡æ„åç¡®ä¿åŠŸèƒ½æ­£å¸¸
3. æ·»åŠ æµ‹è¯•ï¼šé‡æ„æ—¶è¡¥å……å•å…ƒæµ‹è¯•
4. æ–‡æ¡£åŒæ­¥ï¼šæ›´æ–°ä»£ç æ³¨é‡Šå’Œæ–‡æ¡£
5. ä»£ç å®¡æŸ¥ï¼šé‡æ„ä»£ç éœ€è¦å›¢é˜Ÿå®¡æŸ¥

---

ğŸ“ˆ é¢„æœŸæ”¶ç›Š

| æŒ‡æ ‡           | é‡æ„å‰ | é‡æ„å | æå‡  |
| -------------- | ------ | ------ | ----- |
| å¹³å‡æ–‡ä»¶è¡Œæ•°   | 280 è¡Œ | 150 è¡Œ | 46% â†“ |
| ä»£ç å¤ç”¨ç‡     | 40%    | 75%    | 88% â†‘ |
| å•å…ƒæµ‹è¯•è¦†ç›–ç‡ | 0%     | 60%+   | âˆ â†‘   |
| æ–°åŠŸèƒ½å¼€å‘é€Ÿåº¦ | åŸºå‡†   | 1.5x   | 50% â†‘ |
| Bug ä¿®å¤æ—¶é—´   | åŸºå‡†   | 0.6x   | 40% â†“ |

---

éœ€è¦æˆ‘é’ˆå¯¹æŸä¸ªå…·ä½“æ¨¡å—æä¾›è¯¦ç»†çš„é‡æ„ä»£ç ç¤ºä¾‹å—ï¼Ÿæ¯”å¦‚ï¼š

- WebSocket æœåŠ¡å®Œæ•´å®ç°
- éŸ³é¢‘å¤„ç†æ¨¡å—é‡æ„æ–¹æ¡ˆ
- æ•°æ®åº“ Repository å±‚è®¾è®¡

â— æ ¹æ®å¯¹ä½ çš„å‰ç«¯é¡¹ç›®çš„å…¨é¢åˆ†æï¼Œæˆ‘ä¸ºä½ æ•´ç†äº†è¯¦ç»†çš„æ¶æ„è¯„ä¼°æŠ¥å‘Šã€‚è¿™æ˜¯ä¸€ä¸ªåŸºäº React 19 + TypeScript + Zustand + Vite
çš„ä¸­ç­‰è§„æ¨¡çº¯å‰ç«¯åº”ç”¨ï¼ˆçº¦ 18,485 è¡Œä»£ç ï¼‰ï¼Œä¸»è¦ç”¨äº AI éŸ³é¢‘å†…å®¹åˆ›ä½œã€‚

ğŸ“Š é¡¹ç›®åŸºæœ¬æƒ…å†µ

æŠ€æœ¯æ ˆï¼š

- å‰ç«¯æ¡†æ¶ï¼šReact 19.1.0
- æ„å»ºå·¥å…·ï¼šVite 6.2.0
- çŠ¶æ€ç®¡ç†ï¼šZustand 4.5.4ï¼ˆåˆ†ç‰‡æ¨¡å¼ï¼‰
- æ•°æ®æŒä¹…åŒ–ï¼šDexieï¼ˆIndexedDBï¼‰
- AI é›†æˆï¼šGoogle Gemini API
- éŸ³é¢‘å¤„ç†ï¼šWaveSurfer.js

é¡¹ç›®ç»“æ„ï¼šé‡‡ç”¨ç‰¹æ€§é©±åŠ¨æ¶æ„ï¼ˆFeature-drivenï¼‰ï¼Œ7 ä¸ªä¸»è¦åŠŸèƒ½æ¨¡å—ç‹¬ç«‹ç»„ç»‡ã€‚

---

âœ… æ¶æ„ä¼˜åŠ¿

1. æ¨¡å—åŒ–ç¨‹åº¦é«˜ï¼šç‰¹æ€§é©±åŠ¨çš„æ–‡ä»¶å¤¹ç»„ç»‡ï¼Œå…³æ³¨ç‚¹åˆ†ç¦»æ¸…æ™°
2. ç±»å‹å®‰å…¨å®Œæ•´ï¼šTypeScript ä¸¥æ ¼æ¨¡å¼ï¼Œç±»å‹å®šä¹‰è§„èŒƒ
3. çŠ¶æ€ç®¡ç†åˆç†ï¼šZustand åˆ†ç‰‡è®¾è®¡ï¼Œé¿å…å•ä¸€å·¨å‹ store
4. ç¦»çº¿èƒ½åŠ›å¼ºï¼šIndexedDB æœ¬åœ°æŒä¹…åŒ–ï¼Œæ”¯æŒç¦»çº¿ä½¿ç”¨
5. æ‰©å±•æ€§å¥½ï¼šæ·»åŠ æ–°åŠŸèƒ½åªéœ€æ–°å¢ feature æ–‡ä»¶å¤¹

---

âš ï¸ æ¶æ„é—®é¢˜ä¸éœ€è¦é‡æ„çš„åœ°æ–¹

1. å­˜åœ¨"ä¸Šå¸ Hook"é—®é¢˜ï¼ˆæœ€ä¸¥é‡ï¼‰

ä»¥ä¸‹ Hook è¿åå•ä¸€èŒè´£åŸåˆ™ï¼Œæ··åˆäº†å¤šç§èŒè´£ï¼š

ğŸ”´ useVoiceLibrary.tsï¼ˆ478 è¡Œï¼‰

é—®é¢˜ï¼š

- æ··åˆäº† UI çŠ¶æ€ç®¡ç†ã€TTS API é€šä¿¡ã€æ•°æ®åŠ è½½ã€å¯¼å‡ºé€»è¾‘
- å•ä¸ª Hook æ‰¿è½½è¿‡å¤šèŒè´£ï¼Œéš¾ä»¥æµ‹è¯•å’Œç»´æŠ¤

é‡æ„å»ºè®®ï¼š
æ‹†åˆ†ä¸ºï¼š
â”œâ”€â”€ useVoiceLibrary.tsï¼ˆä¸» Hookï¼Œåè°ƒå±‚ï¼‰
â”œâ”€â”€ useTtsApi.tsï¼ˆAPI é€šä¿¡ï¼‰
â”œâ”€â”€ useVoiceLibraryData.tsï¼ˆæ•°æ®åŠ è½½ï¼‰
â””â”€â”€ voiceLibraryExporter.tsï¼ˆå¯¼å‡ºå·¥å…·å‡½æ•°ï¼‰

ğŸ”´ useAudioFileMatcher.tsï¼ˆ463 è¡Œï¼‰

é—®é¢˜ï¼š

- æ··åˆæ–‡ä»¶å¤„ç†ã€éŸ³é¢‘è§£æã€XMP æ ‡è®°è§£æã€çŠ¶æ€æ›´æ–°
- å¤æ‚åº¦è¿‡é«˜ï¼Œå•å…ƒæµ‹è¯•å›°éš¾

é‡æ„å»ºè®®ï¼š
æ‹†åˆ†ä¸ºï¼š
â”œâ”€â”€ useAudioFileMatcher.tsï¼ˆä¸» Hookï¼Œæµç¨‹åè°ƒï¼‰
â”œâ”€â”€ utils/audioParsing.tsï¼ˆæ–‡ä»¶åè§£æã€XMP è§£æï¼‰
â””â”€â”€ utils/audioMatching.tsï¼ˆåŒ¹é…ç®—æ³•ï¼‰

ğŸ”´ AudioAlignmentAssistantPage.tsxï¼ˆ413 è¡Œï¼‰

é—®é¢˜ï¼š

- é¡µé¢ç»„ä»¶æ··åˆäº†å¤§é‡ä¸šåŠ¡é€»è¾‘ã€çŠ¶æ€ç®¡ç†ã€UI æ¸²æŸ“
- è¿åäº†å±•ç¤ºç»„ä»¶å’Œå®¹å™¨ç»„ä»¶åˆ†ç¦»åŸåˆ™

é‡æ„å»ºè®®ï¼š
é‡æ„ä¸ºï¼š
â”œâ”€â”€ AudioAlignmentAssistantPage.tsxï¼ˆå±•ç¤ºå±‚ï¼‰
â”œâ”€â”€ useAudioAlignmentAssistant.tsï¼ˆé€»è¾‘å±‚ Hookï¼‰
â””â”€â”€ æ‹†åˆ†ä¸ºæ›´å°çš„å­ç»„ä»¶ï¼ˆRangeListPanel ç­‰ï¼‰

---

2. ä»£ç è´¨é‡é—®é¢˜

ğŸŸ¡ ç¼ºä¹å•å…ƒæµ‹è¯•

- æ²¡æœ‰æµ‹è¯•æ¡†æ¶é…ç½®
- å…³é”®ä¸šåŠ¡é€»è¾‘ï¼ˆlibã€servicesï¼‰æœªè¦†ç›–æµ‹è¯•
- å»ºè®®ï¼š å¼•å…¥ Vitest + React Testing Library

ğŸŸ¡ ç¼ºä¹ E2E æµ‹è¯•

- å¤æ‚çš„ç”¨æˆ·æµç¨‹ï¼ˆä¸Šä¼  â†’ ç¼–è¾‘ â†’ å¯¼å‡ºï¼‰æ²¡æœ‰è‡ªåŠ¨åŒ–æµ‹è¯•
- å»ºè®®ï¼š å¼•å…¥ Playwright

ğŸŸ¡ ä»£ç æ³¨é‡Šä¸è¶³

- å¤æ‚é€»è¾‘ï¼ˆå¦‚éŸ³é¢‘å¤„ç†ã€AI æ ‡æ³¨ï¼‰ç¼ºå°‘æ³¨é‡Š
- å»ºè®®ï¼š ä¸ºå…³é”®å‡½æ•°æ·»åŠ  JSDoc

---

3. æ€§èƒ½é—®é¢˜

ğŸŸ¡ æœªä½¿ç”¨ä»£ç åˆ†å‰²

- æ‰€æœ‰é¡µé¢æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œé¦–å±åŠ è½½è¾ƒå¤§
- å»ºè®®ï¼š ä½¿ç”¨ React.lazy å¯¹å„ä¸ª Feature è¿›è¡Œè·¯ç”±çº§æ‡’åŠ è½½

// é‡æ„å‰
import UploadPage from './features/upload/UploadPage';

// é‡æ„å
const UploadPage = React.lazy(() => import('./features/upload/UploadPage'));

ğŸŸ¡ é•¿åˆ—è¡¨æœªè™šæ‹ŸåŒ–

- ç« èŠ‚åˆ—è¡¨ã€å°è¯åˆ—è¡¨å¯èƒ½å¾ˆé•¿
- å»ºè®®ï¼š å¼•å…¥ react-window æˆ– react-virtualized

ğŸŸ¡ Tailwind CSS é€šè¿‡ CDN åŠ è½½

- CDN åŠ è½½å½±å“é¦–å±æ€§èƒ½
- å»ºè®®ï¼š æ”¹ç”¨æœ¬åœ°å®‰è£…çš„ Tailwind CLI æ„å»º

---

4. æ¶æ„è®¾è®¡é—®é¢˜

ğŸŸ¡ ç¼ºå°‘é”™è¯¯è¾¹ç•Œ

- React ç»„ä»¶å´©æºƒä¼šå¯¼è‡´æ•´ä¸ªåº”ç”¨ç™½å±
- å»ºè®®ï¼š ä¸ºæ¯ä¸ª Feature æ·»åŠ  Error Boundary

ğŸŸ¡ å…¨å±€çŠ¶æ€è¿‡åº¦ä½¿ç”¨

- æŸäº›åªåœ¨å•ä¸ª Feature ä½¿ç”¨çš„çŠ¶æ€æ”¾åœ¨äº†å…¨å±€ Store
- å»ºè®®ï¼š è¯„ä¼°å“ªäº›çŠ¶æ€å¯ä»¥å±€éƒ¨åŒ–ï¼ˆä½¿ç”¨ useState æˆ– useReducerï¼‰

ğŸŸ¡ types.ts æ–‡ä»¶è¿‡å¤§ï¼ˆ4,897 å­—èŠ‚ï¼‰

- æ‰€æœ‰ç±»å‹å®šä¹‰åœ¨ä¸€ä¸ªæ–‡ä»¶
- å»ºè®®ï¼š æŒ‰æ¨¡å—æ‹†åˆ†ç±»å‹å®šä¹‰

types/
â”œâ”€â”€ project.types.ts
â”œâ”€â”€ character.types.ts
â”œâ”€â”€ audio.types.ts
â””â”€â”€ index.tsï¼ˆç»Ÿä¸€å¯¼å‡ºï¼‰

ğŸŸ¡ ç¼ºå°‘æ’¤é”€/é‡åšåŠŸèƒ½

- ç¼–è¾‘å™¨æ²¡æœ‰ undo/redoï¼Œç”¨æˆ·ä½“éªŒå·®
- å»ºè®®ï¼š å¼•å…¥ immer + å†å²æ ˆå®ç°

---

5. ä¾èµ–å’Œé…ç½®é—®é¢˜

ğŸŸ¡ React 19 åˆšå‘å¸ƒï¼Œç¨³å®šæ€§å¾…è§‚å¯Ÿ

- React 19.1.0 æ˜¯æ–°ç‰ˆæœ¬ï¼Œç”Ÿæ€æ”¯æŒå¯èƒ½ä¸å®Œå–„
- å»ºè®®ï¼š æŒç»­å…³æ³¨ React 19 çš„å·²çŸ¥é—®é¢˜

ğŸŸ¡ Buffer polyfill

- éœ€è¦é…ç½® Buffer polyfill æ”¯æŒ music-metadata-browser
- è¿™æ˜¯æ­£å¸¸çš„ï¼Œä½†å¢åŠ äº†æ„å»ºå¤æ‚åº¦

ğŸŸ¡ WebSocket æœåŠ¡ä¾èµ–æœ¬åœ°è¿›ç¨‹

- ws://127.0.0.1:9002 éœ€è¦å¤–éƒ¨æœåŠ¡è¿è¡Œ
- å»ºè®®ï¼š åœ¨ README ä¸­æ˜ç¡®è¯´æ˜ä¾èµ–

---

6. æ–‡ä»¶ç»„ç»‡é—®é¢˜

ğŸŸ¡ lib æ–‡ä»¶å¤¹æ··æ‚

- lib ä¸­æ—¢æœ‰å·¥å…·å‡½æ•°ï¼Œåˆæœ‰ä¸šåŠ¡é€»è¾‘å¤„ç†
- å»ºè®®ï¼š åˆ†ç¦»ä¸º utilsï¼ˆçº¯å·¥å…·ï¼‰å’Œ libï¼ˆä¸šåŠ¡å¤„ç†ï¼‰

src/
â”œâ”€â”€ utils/ # çº¯å·¥å…·å‡½æ•°ï¼ˆcolorUtils, wavEncoder ç­‰ï¼‰
â””â”€â”€ lib/ # ä¸šåŠ¡é€»è¾‘å¤„ç†ï¼ˆscriptParser, audioProcessing ç­‰ï¼‰

---

ğŸ“‹ é‡æ„ä¼˜å…ˆçº§æ¸…å•

é«˜ä¼˜å…ˆçº§ï¼ˆç«‹å³å¤„ç†ï¼‰

1. âœ… æ‹†åˆ† useVoiceLibrary.ts
2. âœ… æ‹†åˆ† useAudioFileMatcher.ts
3. âœ… é‡æ„ AudioAlignmentAssistantPage.tsx
4. âœ… æ·»åŠ é”™è¯¯è¾¹ç•Œ
5. âœ… ä»£ç åˆ†å‰²ï¼ˆReact.lazyï¼‰

ä¸­ä¼˜å…ˆçº§ï¼ˆè¿‘æœŸå¤„ç†ï¼‰

6. å¼•å…¥ Vitest + ç¼–å†™å•å…ƒæµ‹è¯•
7. å¼•å…¥ Playwright + ç¼–å†™ E2E æµ‹è¯•
8. æ‹†åˆ† types.ts
9. é•¿åˆ—è¡¨è™šæ‹ŸåŒ–
10. æ·»åŠ æ’¤é”€/é‡åšåŠŸèƒ½

ä½ä¼˜å…ˆçº§ï¼ˆåç»­ä¼˜åŒ–ï¼‰

11. æœ¬åœ°åŒ– Tailwind CSS
12. ä¼˜åŒ–å…¨å±€çŠ¶æ€ä½¿ç”¨
13. æ·»åŠ  JSDoc æ³¨é‡Š
14. æ€§èƒ½ç›‘æ§ï¼ˆweb-vitalsï¼‰
15. é”™è¯¯è¿½è¸ªï¼ˆSentryï¼‰

---

ğŸ’¡ æ¨èçš„é‡æ„è·¯çº¿å›¾

é˜¶æ®µ 1ï¼šä»£ç ç»“æ„ä¼˜åŒ–ï¼ˆ1-2 å‘¨ï¼‰

- æ‹†åˆ† 3 ä¸ªå¤§å‹ Hook
- æ·»åŠ é”™è¯¯è¾¹ç•Œ
- å®ç°ä»£ç åˆ†å‰²

é˜¶æ®µ 2ï¼šæµ‹è¯•åŸºç¡€è®¾æ–½ï¼ˆ1-2 å‘¨ï¼‰

- é…ç½® Vitest
- ä¸º libã€services æ·»åŠ å•å…ƒæµ‹è¯•
- æ·»åŠ å…³é”®è·¯å¾„çš„ E2E æµ‹è¯•

é˜¶æ®µ 3ï¼šæ€§èƒ½ä¼˜åŒ–ï¼ˆ1 å‘¨ï¼‰

- é•¿åˆ—è¡¨è™šæ‹ŸåŒ–
- æœ¬åœ°åŒ– Tailwind
- æ„å»ºä¼˜åŒ–

é˜¶æ®µ 4ï¼šåŠŸèƒ½å®Œå–„ï¼ˆ2-3 å‘¨ï¼‰

- æ’¤é”€/é‡åš
- æ›´å¥½çš„é”™è¯¯æç¤º
- ç¦»çº¿æ”¯æŒä¼˜åŒ–

---

ğŸ¯ æ€»ä½“è¯„ä»·

| ç»´åº¦     | è¯„åˆ† | è¯´æ˜                               |
| -------- | ---- | ---------------------------------- |
| ç±»å‹å®‰å…¨ | A    | TypeScript é…ç½®ä¸¥æ ¼ï¼Œç±»å‹å®Œæ•´      |
| æ¨¡å—åŒ–   | B+   | ç‰¹æ€§é©±åŠ¨æ¶æ„ä¼˜ç§€ï¼Œä½†éƒ¨åˆ† Hook è¿‡å¤§ |
| å¯ç»´æŠ¤æ€§ | B    | ç»“æ„æ¸…æ™°ï¼Œä½†éœ€é‡æ„å¤§å‹ Hook        |
| å¯æµ‹è¯•æ€§ | C+   | ç¼ºå°‘æµ‹è¯•ï¼ŒæŸäº› Hook éš¾ä»¥æµ‹è¯•       |
| å¯æ‰©å±•æ€§ | A    | æ¨¡å—åŒ–è®¾è®¡æ”¯æŒå¿«é€Ÿæ‰©å±•             |
| æ€§èƒ½     | B-   | æœ‰ä¼˜åŒ–ç©ºé—´ï¼ˆä»£ç åˆ†å‰²ã€è™šæ‹ŸåŒ–ï¼‰     |
| æ–‡æ¡£     | C    | ä»£ç æ³¨é‡Šå°‘ï¼Œéœ€è¦æ”¹è¿›               |

---

ğŸš€ ç«‹å³å¯æ‰§è¡Œçš„æ”¹è¿›æ­¥éª¤

ä½ ç°åœ¨å¯ä»¥ï¼š

1. åˆ›å»ºé‡æ„åˆ†æ”¯
2. ä»æœ€ä¸¥é‡çš„ useVoiceLibrary.ts å¼€å§‹æ‹†åˆ†
3. æ·»åŠ  Error Boundary åŒ…è£¹å„ä¸ª Feature
4. é…ç½® React.lazy å®ç°ä»£ç åˆ†å‰²
5. ä¸ºé¡¹ç›®æ·»åŠ æµ‹è¯•æ¡†æ¶

éœ€è¦æˆ‘å¸®ä½ å¼€å§‹æŸä¸ªå…·ä½“çš„é‡æ„ä»»åŠ¡å—ï¼Ÿæ¯”å¦‚ï¼š

- é‡æ„æŸä¸ªå¤§å‹ Hook
- é…ç½®æµ‹è¯•æ¡†æ¶
- å®ç°ä»£ç åˆ†å‰²
- æ·»åŠ é”™è¯¯è¾¹ç•Œ

è¯·å‘Šè¯‰æˆ‘ä½ æƒ³ä»å“ªé‡Œå¼€å§‹ï¼
